# Goal

The goal of this document is to summarize the concept of inode in Linux file systems with simple copy-paste examples.

# Diving Time

1 hour

# TOC

<!-- TOC -->

- [Goal](#goal)
- [Diving Time](#diving-time)
- [TOC](#toc)
- [Dive in](#dive-in)
  - [General definition of inode](#general-definition-of-inode)
  - [Benefits of separating file name (location) and inode](#benefits-of-separating-file-name-location-and-inode)
  - [What's inside the inode](#whats-inside-the-inode)
    - [Why two links already for the directory?](#why-two-links-already-for-the-directory)
      - [Why not allowed?](#why-not-allowed)
    - [You can also which file contains that specific inode](#you-can-also-which-file-contains-that-specific-inode)
  - [Dive into the node](#dive-into-the-node)

<!-- /TOC -->


# Dive in

## General definition of inode
inode, short for `index node`, is a fundamental concept in Unix-like file systems that serves as a data structure to store information about files and directories. Each `file` *or* `directory` on the file system is represented by an inode, which contains metadata about the file but *NOT* its name or actual data content.

![inode](./assets/inode.png)

## Benefits of separating file name (location) and inode

Users can modify its file name or move it to a different directory without changing the underlying inode.

## What's inside the inode

Setup:
```sh
tmp_date=$(date +%y%m%d_%H%M%S_test)
mkdir -p ~/test_dive/$tmp_date && cd ~/test_dive/$tmp_date

echo 'Hello Inode!' > sample_file.txt
mkdir sample_dir
```

Test:
```sh
stat -x sample_file.txt
#   File: "sample_file.txt"
#   Size: 13           FileType: Regular File
#   Mode: (0644/-rw-r--r--)         Uid: (  501/     ajk)  Gid: (   20/   staff)
# Device: 1,17   Inode: 110676931    Links: 1
# Access: Sun Nov 30 13:47:49 2025
# Modify: Sun Nov 30 13:47:48 2025
# Change: Sun Nov 30 13:47:48 2025
#  Birth: Sun Nov 30 13:47:48 2025
```

Test:
```sh
stat -x sample_dir
#   File: "sample_dir"
#   Size: 64           FileType: Directory
#   Mode: (0755/drwxr-xr-x)         Uid: (  501/     ajk)  Gid: (   20/   staff)
# Device: 1,17   Inode: 110678458    Links: 2
# Access: Sun Nov 30 13:55:40 2025
# Modify: Sun Nov 30 13:55:40 2025
# Change: Sun Nov 30 13:55:40 2025
#  Birth: Sun Nov 30 13:55:40 2025
```

### Why two links already for the directory?

When you create a new directory, it creates two links by default:
- One link for the directory itself (`.`) inside the directory `./sample_dir`
- One link for its parent directory to go to that directory (`./sample_dir`)

Can we create another hard link for the directory?
```sh
ln sample_dir sample_hard_link_dir
# ln: sample_hard_link_dir: hard link not allowed for directory
```

#### Why not allowed?
Creating hard links to directories can lead to complex and confusing file system structures, making it difficult to maintain the integrity of the file system. It can create cycles and make it hard to traverse the directory tree, leading to potential issues with file system consistency and navigation.

However, superusers (root) can create hard links to directories using special commands, but this is generally discouraged and not recommended for regular users due to the potential complications it can introduce.

Apple's time machine backup system uses hard links for directories to efficiently manage backups, but this is a specialized use case handled by the system itself.

### You can also which file contains that specific inode

Please find a file with inode number `110676931`
```sh
find . -inum 110676931
# ./sample_file.txt
```

## Dive into the node
