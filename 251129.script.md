# Goal

The goal of this document is to dive deep into the following commands:
```sh
cd /
cd -
cd
cd ..
```

# Target Audience
This document is intended for users who have a basic understanding of Linux command line operations and wish to deepen their knowledge of directory navigation commands, with simple copy-paste examples.

# TOC
<!-- TOC -->

- [Goal](#goal)
- [Target Audience](#target-audience)
- [TOC](#toc)
- [Backgrounds](#backgrounds)
- [Dive in](#dive-in)
  - [How to check source code of `cd` command?](#how-to-check-source-code-of-cd-command)
  - [How do we know which shell we are using?](#how-do-we-know-which-shell-we-are-using)
  - [Let's quickly check the version](#lets-quickly-check-the-version)
  - [Let's check the source code of `cd` command in `zsh`](#lets-check-the-source-code-of-cd-command-in-zsh)
  - [Get each code](#get-each-code)
  - [Dive deep into what each line of code does](#dive-deep-into-what-each-line-of-code-does)
    - [844-847](#844-847)
    - [](#)
    - [ㅁ](#ㅁ)
    - [First time seeing 25 years old commit](#first-time-seeing-25-years-old-commit)

<!-- /TOC -->

# Backgrounds
If you have had a chance to work with Linux, the commands above are pretty common for navigating through directories. You may already know what they do, but let's dive deep into each of them to understand their behaviors.
- `cd /:` Navigates to the Root directory
- `cd ..:` Navigates to the Parent directory
- `cd:` Navigates to the Home directory (equivalent to `cd ~`)
- `cd -:` Navigates to the Previous directory

While the first three are straightforward, `cd -` behaves like a "Back" button. But how does the shell remember where I was?

# Dive in

## How to check source code of `cd` command?

```sh
type cd
# cd is a shell builtin
```

`shell builtin` means that the command `cd` is implemented directly within the shell (like `bash`, `zsh`, etc.)


## How do we know which shell we are using?
```sh
echo $SHELL
# /bin/zsh
```

OR you may:
```sh
echo $0
# -zsh
```

## Let's quickly check the version


```sh
/bin/zsh --version
# or: `zsh --version`
# zsh 5.9 (arm64-apple-darwin24.0)
```

## Let's check the source code of `cd` command in `zsh`

> [!INFO]
> The following is a mirror link of the official repository of `zsh`

https://github.com/zsh-users/zsh


## Get each code

The core functions are the following:
- `cd_get_dest()`: does the initial argument processing
- `cd_do_chdir()`: actually changes directory, if possible
- `cd_new_pwd()`: does the ancillary processing associated with actually changing directory


## Dive deep into what each line of code does

### 844-847

```c
if (isset(RESTRICTED)) {
	zwarnnam(nam, "restricted");
	return 1;
}
```

> [!INFO]
> zwarnnam is a compound word for: `z`(ZSH) + `warn` (WARNING) + `nam` (NAME)
> A function for error output with consistent formatting.

This code checks if the shell is running in restricted mode by using the `isset(RESTRICTED)` function. If it is, it issues a warning message "restricted" using the `zwarnnam` function and returns `1`, indicating an error. In restricted mode, certain commands, including changing directories - `cd` -, may be limited to enhance security.

Will return the following output when you try to use `cd` in restricted mode:

```sh
zsh: cd: restricted
```


### 

```c
  chasinglinks = OPT_ISSET(ops,'P') || (isset(CHASELINKS) && !OPT_ISSET(ops,'L'));
```

`chasinglinks` is a boolean value, meaning is_chasing_symbolic_links or not.
It is `true` if :
- If user specifies `-P` option
- If user has a preference setting CHASELINKS enabled
  - You can temporarily override this setting by specifying `-L` option



Setup:
```sh
tmp_dir=$(date +%y%m%d_%H%M%S_test)
mkdir $tmp_dir && cd $tmp_dir
mkdir physical_path
ln -s physical_path symbolic_link
```

Check:
```sh
ls -al
# total 0
# drwxr-xr-x   4 ajk  staff   128 Nov 29 13:58 .
# drwxr-x---+ 73 ajk  staff  2336 Nov 29 13:54 ..
# drwxr-xr-x   3 ajk  staff    96 Nov 29 13:58 physical_path
# lrwxr-xr-x   1 ajk  staff    13 Nov 29 13:58 symbolic_link -> physical_path

```


### ㅁ

```sh
queue_signals();
```

Make sure that other signals (like interrupts) do not interfere with the execution of the `cd` command. This is important because changing directories is a critical operation, and we want to ensure it completes without interruption.


### First time seeing 25 years old commit

![25_years_ago_commit](/assets/25_years_ago_commit.png)